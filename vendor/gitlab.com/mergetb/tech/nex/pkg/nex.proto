syntax = "proto3";
package nex;

import "google/protobuf/wrappers.proto";
import "google/protobuf/timestamp.proto";

service Nex {

  /* membership */
  rpc GetMembers(GetMembersRequest) returns (GetMembersResponse);
  rpc AddMembers(MemberList) returns (AddMembersResponse);
  rpc DeleteMembers(DeleteMembersRequest) returns (DeleteMembersResponse);
  rpc UpdateMembers(UpdateList) returns (UpdateMembersResponse);

  /* network */
  rpc GetNetworks(GetNetworksRequest) returns (GetNetworksResponse);
  rpc GetNetwork(GetNetworkRequest) returns (GetNetworkResponse);
  rpc AddNetwork(AddNetworkRequest) returns (AddNetworkResponse);
  rpc DeleteNetwork(DeleteNetworkRequest) returns (DeleteNetworkResponse);

}


/* network ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
message Network {
  string name = 1;
  string subnet4 = 2;
  string subnet6 = 3;
  string dhcp4server = 4;
  string dhcp6server = 5;
  AddressRange Range4 = 6;
  AddressRange Range6 = 7;
  repeated string gateways = 8;
  repeated string nameservers = 9;
  repeated Option options = 10;
  string domain = 11;
  AddressRange macRange = 12;
}

message NetworkUpdate {
  google.protobuf.StringValue name = 1;
  google.protobuf.StringValue subnet4 = 2;
  google.protobuf.StringValue subnet6 = 3;
  google.protobuf.StringValue dhcp4server = 4;
  google.protobuf.StringValue dhcp6server = 5;
  AddressRange Range4 = 6;
  AddressRange Range6 = 7;
  repeated string gateways = 8;
  repeated string nameservers = 9;
  repeated Option options = 10;
  google.protobuf.StringValue domain = 11;
  AddressRange macRange = 12;
}

message AddressRange {
  string begin = 1;
  string end = 2;
}

message Option {
  int32 number = 1;
  string value = 2;
}

/* memberhsip ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
message AddMemberRequest {
  string network = 1;
  repeated string mac = 2;
}
message AddMemberResponse { }

message DeleteMembersRequest {
  string network = 1;
  repeated string list = 2;
}
message DeleteMembersResponse { }

message GetMembersRequest {
  string network = 1;
}
message GetMembersResponse { 
  repeated Member members = 1;
}

message Member {
  string mac = 1;
  string name = 2;
  Lease ip4 = 3;
  Lease ip6 = 4;
  string net = 5;
}

message Lease {
  string address = 1;
  google.protobuf.Timestamp expires = 2;
}

message MemberUpdate {
  string mac = 1;
  google.protobuf.StringValue name = 2;
  Lease ip4 = 3;
  Lease ip6 = 4;
}

message MemberList {
  string net = 1;
  repeated Member list = 2;
}
message AddMembersResponse {}

message UpdateList {
  string net = 1;
  repeated MemberUpdate list = 2;
}
message UpdateMembersResponse {}

message AddNetworkRequest {
  Network network = 1;
}
message AddNetworkResponse {}

message DeleteNetworkRequest {
  string name = 1;
}
message DeleteNetworkResponse {}

message GetNetworkRequest {
  string name = 1;
}
message GetNetworkResponse {
  Network net = 1;
}

message GetNetworksRequest {
}
message GetNetworksResponse {
  //repeated Network nets = 1;
  repeated string nets = 1;
}


